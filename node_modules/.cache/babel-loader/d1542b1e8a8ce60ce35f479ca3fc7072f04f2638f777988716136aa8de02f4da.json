{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-1126a62c\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"step-content\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"Final Step\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0,\n  class: \"project-info\"\n};\nconst _hoisted_4 = {\n  key: 0\n};\nconst _hoisted_5 = {\n  class: \"project-status\"\n};\nconst _hoisted_6 = [\"disabled\"];\nconst _hoisted_7 = [\"disabled\"];\nconst _hoisted_8 = {\n  key: 1,\n  class: \"error-message\"\n};\nconst _hoisted_9 = {\n  key: 1,\n  class: \"project-info warning\"\n};\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \" This content is not saved to a project. Create a new project to save your work. \", -1 /* HOISTED */));\nconst _hoisted_11 = [_hoisted_10];\nconst _hoisted_12 = {\n  class: \"final-content\"\n};\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", {\n  class: \"mb-3\"\n}, \"Generated Content\", -1 /* HOISTED */));\nconst _hoisted_14 = {\n  key: 0,\n  class: \"d-flex justify-content-center\"\n};\nconst _hoisted_15 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"spinner-border text-primary\",\n  role: \"status\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"visually-hidden\"\n}, \"Loading...\")], -1 /* HOISTED */));\nconst _hoisted_16 = [_hoisted_15];\nconst _hoisted_17 = [\"innerHTML\"];\nconst _hoisted_18 = {\n  class: \"final-image-section\"\n};\nconst _hoisted_19 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", null, \"Generated Image\", -1 /* HOISTED */));\nconst _hoisted_20 = {\n  class: \"image-section\"\n};\nconst _hoisted_21 = {\n  key: 0,\n  class: \"d-flex justify-content-center align-items-center image-loading\"\n};\nconst _hoisted_22 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"spinner-border text-primary\",\n  role: \"status\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"visually-hidden\"\n}, \"Loading...\")], -1 /* HOISTED */));\nconst _hoisted_23 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", {\n  class: \"loading-text\"\n}, \"Loading image...\", -1 /* HOISTED */));\nconst _hoisted_24 = [_hoisted_22, _hoisted_23];\nconst _hoisted_25 = {\n  key: 1,\n  class: \"no-image-placeholder\"\n};\nconst _hoisted_26 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fa-solid fa-triangle-exclamation fa-3x\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_27 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fa-solid fa-image\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_28 = [\"src\"];\nconst _hoisted_29 = {\n  key: 3,\n  class: \"no-image-placeholder\"\n};\nconst _hoisted_30 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fa-solid fa-image fa-5x\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_31 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"Không có hình ảnh\", -1 /* HOISTED */));\nconst _hoisted_32 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fa-solid fa-image\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_33 = {\n  class: \"image-actions\"\n};\nconst _hoisted_34 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-magic me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_35 = {\n  class: \"final-actions\"\n};\nconst _hoisted_36 = {\n  class: \"action-buttons\"\n};\nconst _hoisted_37 = {\n  class: \"additional-actions\"\n};\nconst _hoisted_38 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-file-export me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_39 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-share-alt me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_40 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-file-pdf me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_41 = {\n  class: \"navigation-buttons\"\n};\nconst _hoisted_42 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-arrow-left me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_43 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-home me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_44 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-home me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_45 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-plus me-1\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_46 = {\n  class: \"toast-container\"\n};\nconst _hoisted_47 = [\"onClick\"];\nconst _hoisted_48 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"toast-close-btn\"\n}, \"×\", -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, $options.hasProjectId ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"h3\", null, _toDisplayString($props.projectTitle), 1 /* TEXT */), $props.projectDescription ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _toDisplayString($props.projectDescription), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"span\", {\n    class: _normalizeClass(['status-badge', $data.projectStatus])\n  }, _toDisplayString($data.projectStatus === \"in_progress\" ? \"In Progress\" : \"Finished\"), 3 /* TEXT, CLASS */), $data.projectStatus === 'in_progress' ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    class: \"status-button\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.markAsFinished && $options.markAsFinished(...args)),\n    disabled: $data.loading\n  }, _toDisplayString($data.loading ? \"Updating...\" : \"Mark as Finished\"), 9 /* TEXT, PROPS */, _hoisted_6)) : (_openBlock(), _createElementBlock(\"button\", {\n    key: 1,\n    class: \"status-button\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.markAsInProgress && $options.markAsInProgress(...args)),\n    disabled: $data.loading\n  }, _toDisplayString($data.loading ? \"Updating...\" : \"Mark as In Progress\"), 9 /* TEXT, PROPS */, _hoisted_7))]), $data.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, _toDisplayString($data.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [..._hoisted_11])), _createElementVNode(\"div\", _hoisted_12, [_hoisted_13, $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [..._hoisted_16])) : (_openBlock(), _createElementBlock(\"div\", {\n    key: 1,\n    class: \"content-box\",\n    innerHTML: $options.formattedContent\n  }, null, 8 /* PROPS */, _hoisted_17))]), _createElementVNode(\"div\", _hoisted_18, [_hoisted_19, _createElementVNode(\"div\", _hoisted_20, [$data.imageLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [..._hoisted_24])) : $data.imageError ? (_openBlock(), _createElementBlock(\"div\", _hoisted_25, [_hoisted_26, _createElementVNode(\"p\", null, _toDisplayString($data.imageError), 1 /* TEXT */), $options.hasContentId ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.generateImageForContent && $options.generateImageForContent(...args)),\n    class: \"btn btn-primary mt-3\"\n  }, [_hoisted_27, _createTextVNode(\" Tạo hình ảnh mới \")])) : _createCommentVNode(\"v-if\", true)])) : $options.imageUrl ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 2,\n    src: $options.imageUrl,\n    alt: \"Generated image\",\n    class: \"img-fluid rounded mb-3\",\n    onError: _cache[3] || (_cache[3] = (...args) => $options.handleImageError && $options.handleImageError(...args)),\n    onLoad: _cache[4] || (_cache[4] = (...args) => $options.handleImageLoad && $options.handleImageLoad(...args))\n  }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_28)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_29, [_hoisted_30, _hoisted_31, $options.hasContentId ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.generateImageForContent && $options.generateImageForContent(...args)),\n    class: \"btn btn-primary mt-3\"\n  }, [_hoisted_32, _createTextVNode(\" Tạo hình ảnh \")])) : _createCommentVNode(\"v-if\", true)])), _createElementVNode(\"div\", _hoisted_33, [!$data.imageLoading && !$options.imageUrl && $props.contentId ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    class: \"btn btn-success mt-2\",\n    onClick: _cache[6] || (_cache[6] = (...args) => $options.generateImageForContent && $options.generateImageForContent(...args))\n  }, [_hoisted_34, _createTextVNode(\" Generate Image \")])) : _createCommentVNode(\"v-if\", true)])])]), _createElementVNode(\"div\", _hoisted_35, [_createElementVNode(\"div\", _hoisted_36, [_createElementVNode(\"div\", _hoisted_37, [_createElementVNode(\"button\", {\n    class: \"btn btn-outline-primary\",\n    onClick: _cache[7] || (_cache[7] = (...args) => $options.exportContent && $options.exportContent(...args))\n  }, [_hoisted_38, _createTextVNode(\" Export \")]), _createElementVNode(\"button\", {\n    class: \"btn btn-outline-primary\",\n    onClick: _cache[8] || (_cache[8] = (...args) => $options.shareContent && $options.shareContent(...args))\n  }, [_hoisted_39, _createTextVNode(\" Share \")]), _createElementVNode(\"button\", {\n    class: \"btn btn-outline-primary\",\n    onClick: _cache[9] || (_cache[9] = (...args) => $options.downloadPDF && $options.downloadPDF(...args))\n  }, [_hoisted_40, _createTextVNode(\" Download PDF \")])])]), _createElementVNode(\"div\", _hoisted_41, [!$props.fromDashboard ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    class: \"btn btn-light\",\n    onClick: _cache[10] || (_cache[10] = $event => _ctx.$emit('prev'))\n  }, [_hoisted_42, _createTextVNode(\" Previous Step \")])) : (_openBlock(), _createElementBlock(\"button\", {\n    key: 1,\n    class: \"btn btn-light\",\n    onClick: _cache[11] || (_cache[11] = $event => _ctx.$emit('go-to-dashboard'))\n  }, [_hoisted_43, _createTextVNode(\" Back to Dashboard \")])), _createElementVNode(\"button\", {\n    class: \"btn btn-info\",\n    onClick: _cache[12] || (_cache[12] = $event => _ctx.$emit('go-to-dashboard'))\n  }, [_hoisted_44, _createTextVNode(\" Dashboard \")]), _createElementVNode(\"button\", {\n    class: \"btn btn-success\",\n    onClick: _cache[13] || (_cache[13] = $event => _ctx.$emit('new'))\n  }, [_hoisted_45, _createTextVNode(\" Create New \")])])]), $data.saveMessage ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 2,\n    class: _normalizeClass(['save-message', $data.saveStatus])\n  }, _toDisplayString($data.saveMessage), 3 /* TEXT, CLASS */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Toast Messages Container \"), _createElementVNode(\"div\", _hoisted_46, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.toasts, toast => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: toast.id,\n      class: _normalizeClass(['toast-message', `toast-${toast.type}`]),\n      onClick: $event => $options.removeToast(toast.id)\n    }, [_createElementVNode(\"span\", null, _toDisplayString(toast.message), 1 /* TEXT */), _hoisted_48], 10 /* CLASS, PROPS */, _hoisted_47);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","_createElementVNode","key","_hoisted_10","role","_hoisted_15","_hoisted_22","_hoisted_23","_createElementBlock","_hoisted_1","_hoisted_2","$options","hasProjectId","_hoisted_3","_toDisplayString","$props","projectTitle","projectDescription","_hoisted_4","_createCommentVNode","_hoisted_5","_normalizeClass","$data","projectStatus","onClick","_cache","args","markAsFinished","disabled","loading","_hoisted_6","markAsInProgress","_hoisted_7","error","_hoisted_8","_hoisted_9","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_16","innerHTML","formattedContent","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","imageLoading","_hoisted_21","_hoisted_24","imageError","_hoisted_25","_hoisted_26","hasContentId","generateImageForContent","_hoisted_27","_createTextVNode","imageUrl","src","alt","onError","handleImageError","onLoad","handleImageLoad","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","contentId","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","exportContent","_hoisted_38","shareContent","_hoisted_39","downloadPDF","_hoisted_40","_hoisted_41","fromDashboard","$event","_ctx","$emit","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","saveMessage","saveStatus","_hoisted_46","_Fragment","_renderList","toasts","toast","id","type","removeToast","message","_hoisted_48","_hoisted_47"],"sources":["/Users/nhannguyen/Desktop/Duan/esmart-solutions-agency/src/components/creator-ai/FinalStep.vue"],"sourcesContent":["<template>\n  <div class=\"step-content\">\n    <h2>Final Step</h2>\n    <div v-if=\"hasProjectId\" class=\"project-info\">\n      <h3>{{ projectTitle }}</h3>\n      <p v-if=\"projectDescription\">{{ projectDescription }}</p>\n      <div class=\"project-status\">\n        <span :class=\"['status-badge', projectStatus]\">\n          {{ projectStatus === \"in_progress\" ? \"In Progress\" : \"Finished\" }}\n        </span>\n        <button\n          v-if=\"projectStatus === 'in_progress'\"\n          class=\"status-button\"\n          @click=\"markAsFinished\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? \"Updating...\" : \"Mark as Finished\" }}\n        </button>\n        <button\n          v-else\n          class=\"status-button\"\n          @click=\"markAsInProgress\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? \"Updating...\" : \"Mark as In Progress\" }}\n        </button>\n      </div>\n      <p v-if=\"error\" class=\"error-message\">{{ error }}</p>\n    </div>\n    <div v-else class=\"project-info warning\">\n      <p>\n        This content is not saved to a project. Create a new project to save\n        your work.\n      </p>\n    </div>\n    <div class=\"final-content\">\n      <h3 class=\"mb-3\">Generated Content</h3>\n      <div v-if=\"loading\" class=\"d-flex justify-content-center\">\n        <div class=\"spinner-border text-primary\" role=\"status\">\n          <span class=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n      <div v-else class=\"content-box\" v-html=\"formattedContent\"></div>\n    </div>\n\n    <div class=\"final-image-section\">\n      <h3>Generated Image</h3>\n      <div class=\"image-section\">\n        <div\n          v-if=\"imageLoading\"\n          class=\"d-flex justify-content-center align-items-center image-loading\"\n        >\n          <div class=\"spinner-border text-primary\" role=\"status\">\n            <span class=\"visually-hidden\">Loading...</span>\n          </div>\n          <p class=\"loading-text\">Loading image...</p>\n        </div>\n        <div v-else-if=\"imageError\" class=\"no-image-placeholder\">\n          <i class=\"fa-solid fa-triangle-exclamation fa-3x\"></i>\n          <p>{{ imageError }}</p>\n          <button\n            v-if=\"hasContentId\"\n            @click=\"generateImageForContent\"\n            class=\"btn btn-primary mt-3\"\n          >\n            <i class=\"fa-solid fa-image\"></i> Tạo hình ảnh mới\n          </button>\n        </div>\n        <img\n          v-else-if=\"imageUrl\"\n          :src=\"imageUrl\"\n          alt=\"Generated image\"\n          class=\"img-fluid rounded mb-3\"\n          @error=\"handleImageError\"\n          @load=\"handleImageLoad\"\n        />\n        <div v-else class=\"no-image-placeholder\">\n          <i class=\"fa-solid fa-image fa-5x\"></i>\n          <p>Không có hình ảnh</p>\n          <button\n            v-if=\"hasContentId\"\n            @click=\"generateImageForContent\"\n            class=\"btn btn-primary mt-3\"\n          >\n            <i class=\"fa-solid fa-image\"></i> Tạo hình ảnh\n          </button>\n        </div>\n\n        <div class=\"image-actions\">\n          <button\n            v-if=\"!imageLoading && !imageUrl && contentId\"\n            class=\"btn btn-success mt-2\"\n            @click=\"generateImageForContent\"\n          >\n            <i class=\"fas fa-magic me-1\"></i>\n            Generate Image\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"final-actions\">\n      <div class=\"action-buttons\">\n        <div class=\"additional-actions\">\n          <button class=\"btn btn-outline-primary\" @click=\"exportContent\">\n            <i class=\"fas fa-file-export me-1\"></i>\n            Export\n          </button>\n          <button class=\"btn btn-outline-primary\" @click=\"shareContent\">\n            <i class=\"fas fa-share-alt me-1\"></i>\n            Share\n          </button>\n          <button class=\"btn btn-outline-primary\" @click=\"downloadPDF\">\n            <i class=\"fas fa-file-pdf me-1\"></i>\n            Download PDF\n          </button>\n        </div>\n      </div>\n      <div class=\"navigation-buttons\">\n        <button\n          v-if=\"!fromDashboard\"\n          class=\"btn btn-light\"\n          @click=\"$emit('prev')\"\n        >\n          <i class=\"fas fa-arrow-left me-1\"></i>\n          Previous Step\n        </button>\n        <button v-else class=\"btn btn-light\" @click=\"$emit('go-to-dashboard')\">\n          <i class=\"fas fa-home me-1\"></i>\n          Back to Dashboard\n        </button>\n        <button class=\"btn btn-info\" @click=\"$emit('go-to-dashboard')\">\n          <i class=\"fas fa-home me-1\"></i>\n          Dashboard\n        </button>\n        <button class=\"btn btn-success\" @click=\"$emit('new')\">\n          <i class=\"fas fa-plus me-1\"></i>\n          Create New\n        </button>\n      </div>\n    </div>\n    <div v-if=\"saveMessage\" :class=\"['save-message', saveStatus]\">\n      {{ saveMessage }}\n    </div>\n\n    <!-- Toast Messages Container -->\n    <div class=\"toast-container\">\n      <div\n        v-for=\"toast in toasts\"\n        :key=\"toast.id\"\n        :class=\"['toast-message', `toast-${toast.type}`]\"\n        @click=\"removeToast(toast.id)\"\n      >\n        <span>{{ toast.message }}</span>\n        <button class=\"toast-close-btn\">&times;</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"FinalStep\",\n  props: {\n    content: {\n      type: String,\n      required: true,\n    },\n    generatedImage: {\n      type: String,\n      default: null,\n    },\n    projectId: {\n      type: String,\n      default: \"\",\n    },\n    projectTitle: {\n      type: String,\n      default: \"Content Project\",\n    },\n    projectDescription: {\n      type: String,\n      default: \"\",\n    },\n    contentId: {\n      type: String,\n      default: \"\",\n    },\n    fromDashboard: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      projectStatus: \"in_progress\",\n      loading: false,\n      error: null,\n      saveLoading: false,\n      saveMessage: null,\n      saveStatus: \"success\",\n      imageLoading: false,\n      imageError: null,\n      localImage: this.generatedImage,\n      toasts: [],\n    };\n  },\n  computed: {\n    apiEndpoint() {\n      return process.env.VUE_APP_API_URL || \"http://localhost:3001/api\";\n    },\n    hasProjectId() {\n      return this.projectId && this.projectId.length > 0;\n    },\n    hasContentId() {\n      return this.contentId && this.contentId.length > 0;\n    },\n    formattedContent() {\n      if (!this.content) return \"\";\n\n      // Tạo định dạng HTML cho nội dung\n      const formatted = this.content\n        // Thay thế dòng trống bằng thẻ đoạn\n        .replace(/\\n\\s*\\n/g, \"</p><p>\")\n        // Thay thế dòng mới đơn bằng thẻ br\n        .replace(/\\n/g, \"<br>\")\n        // Bọc toàn bộ nội dung trong thẻ p\n        .replace(/^(.+)$/, \"<p>$1</p>\");\n\n      return formatted;\n    },\n    imageUrl() {\n      // First, use localImage from data if available\n      if (this.localImage) {\n        console.log(\n          \"Using local image:\",\n          this.localImage.substring(0, 50) + \"...\"\n        );\n\n        // Ensure the URL is properly formatted for deployment\n        return this.ensureAbsoluteUrl(this.localImage);\n      }\n\n      // Next, try to use generated image from props\n      if (this.generatedImage) {\n        console.log(\n          \"Using generated image from props:\",\n          typeof this.generatedImage === \"string\"\n            ? this.generatedImage.substring(0, 50) + \"...\"\n            : \"object\"\n        );\n\n        // Handle string URLs (including data URLs)\n        if (typeof this.generatedImage === \"string\") {\n          return this.ensureAbsoluteUrl(this.generatedImage);\n        }\n\n        // Handle object format\n        if (\n          typeof this.generatedImage === \"object\" &&\n          this.generatedImage !== null\n        ) {\n          if (\"image\" in this.generatedImage) {\n            return this.ensureAbsoluteUrl(this.generatedImage.image);\n          }\n          if (\"imageUrl\" in this.generatedImage) {\n            return this.ensureAbsoluteUrl(this.generatedImage.imageUrl);\n          }\n        }\n      }\n\n      return null;\n    },\n  },\n  created() {\n    console.log(\"FinalStep created\");\n    console.log(\"generatedImage prop:\", this.generatedImage);\n    console.log(\"contentId prop:\", this.contentId);\n\n    // Set initial local image from props\n    if (this.generatedImage) {\n      this.localImage = this.generatedImage;\n    } else {\n      this.localImage = null;\n    }\n\n    if (this.hasProjectId) {\n      this.fetchProjectStatus();\n    }\n\n    // Always fetch content image if we have contentId, regardless of generatedImage prop\n    if (this.hasContentId) {\n      this.fetchContentImage();\n    }\n  },\n  methods: {\n    async fetchProjectStatus() {\n      try {\n        if (!this.hasProjectId) return;\n\n        const response = await axios.get(\n          `${this.apiEndpoint}/projects/${this.projectId}`\n        );\n        if (response.data.success) {\n          this.projectStatus = response.data.data.status;\n        }\n      } catch (error) {\n        console.error(\"Error fetching project status:\", error);\n        this.error = \"Could not fetch project status\";\n      }\n    },\n    async fetchContentImage() {\n      if (!this.contentId) {\n        console.log(\"No contentId available to fetch image\");\n        this.localImage = null;\n        return;\n      }\n\n      try {\n        console.log(\n          `Starting to fetch image for content ID: ${this.contentId}`\n        );\n        this.imageLoading = true;\n        this.imageError = null;\n\n        // Use a timeout to prevent hanging requests\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), 15000); // 15 second timeout\n\n        const response = await axios.get(\n          `/api/content/contents/${this.contentId}`,\n          { signal: controller.signal }\n        );\n\n        clearTimeout(timeoutId);\n\n        console.log(\n          `Content API response for ID ${this.contentId}:`,\n          response.data\n        );\n\n        if (response.data && response.data.success) {\n          const contentData = response.data.data;\n\n          if (contentData && contentData.imageUrl) {\n            console.log(\n              `Found image URL for content ${this.contentId}:`,\n              contentData.imageUrl\n            );\n\n            // Store the original URL\n            const originalUrl = contentData.imageUrl;\n\n            // Try to load the image first to check if it exists\n            try {\n              const img = new Image();\n              img.onload = () => {\n                console.log(\"Image loaded successfully from original URL\");\n                this.localImage = originalUrl;\n                this.$emit(\"update:image\", originalUrl);\n                this.imageLoading = false;\n              };\n\n              img.onerror = async () => {\n                console.log(\n                  \"Failed to load image from original URL, trying alternate paths\"\n                );\n\n                // Try with /api prefix for server uploads\n                if (originalUrl.includes(\"uploads/\")) {\n                  const uploadPathMatch = originalUrl.match(/(uploads\\/.*$)/);\n                  if (uploadPathMatch && uploadPathMatch[1]) {\n                    const apiUrl = `/api/image/${uploadPathMatch[1]}`;\n                    console.log(\"Trying with API URL:\", apiUrl);\n\n                    // Check if this URL works\n                    const altImg = new Image();\n                    altImg.onload = () => {\n                      console.log(\"Image loaded successfully from API URL\");\n                      this.localImage = apiUrl;\n                      this.$emit(\"update:image\", apiUrl);\n                      this.imageLoading = false;\n                    };\n\n                    altImg.onerror = () => {\n                      console.log(\"Failed to load image from API URL\");\n                      this.imageError = \"Image could not be loaded\";\n                      this.localImage = null;\n                      this.imageLoading = false;\n                    };\n\n                    altImg.src = apiUrl;\n                  } else {\n                    this.imageError = \"Invalid image path format\";\n                    this.localImage = null;\n                    this.imageLoading = false;\n                  }\n                } else {\n                  this.imageError = \"Image not found\";\n                  this.localImage = null;\n                  this.imageLoading = false;\n                }\n              };\n\n              // Ensure the URL is properly formatted\n              img.src = this.ensureAbsoluteUrl(originalUrl);\n            } catch (imgError) {\n              console.error(\"Error checking image:\", imgError);\n              this.localImage = contentData.imageUrl;\n              this.$emit(\"update:image\", contentData.imageUrl);\n            }\n          } else {\n            console.log(`No image found for content ${this.contentId}`);\n            this.localImage = null;\n            this.imageLoading = false;\n          }\n        } else {\n          console.warn(\"API did not return success:\", response.data);\n          this.localImage = null;\n          this.imageLoading = false;\n        }\n      } catch (error) {\n        console.error(\"Error fetching content image:\", error);\n\n        if (error.name === \"AbortError\") {\n          this.imageError = \"Request timed out when loading image\";\n        } else {\n          this.imageError = \"Failed to load image: \" + error.message;\n        }\n\n        this.localImage = null;\n        this.imageLoading = false;\n      }\n    },\n    async markAsFinished() {\n      try {\n        if (!this.hasProjectId) {\n          alert(\"Cannot update status: No project ID available\");\n          return;\n        }\n\n        this.loading = true;\n        const response = await axios.patch(\n          `${this.apiEndpoint}/projects/${this.projectId}/status`,\n          {\n            status: \"finished\",\n          }\n        );\n\n        if (response.data.success) {\n          this.projectStatus = \"finished\";\n        }\n      } catch (error) {\n        console.error(\"Error updating project status:\", error);\n        alert(\"Failed to update project status: \" + error.message);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async markAsInProgress() {\n      try {\n        if (!this.hasProjectId) {\n          alert(\"Cannot update status: No project ID available\");\n          return;\n        }\n\n        this.loading = true;\n        const response = await axios.patch(\n          `${this.apiEndpoint}/projects/${this.projectId}/status`,\n          {\n            status: \"in_progress\",\n          }\n        );\n\n        if (response.data.success) {\n          this.projectStatus = \"in_progress\";\n        }\n      } catch (error) {\n        console.error(\"Error updating project status:\", error);\n        alert(\"Failed to update project status: \" + error.message);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async saveContent() {\n      try {\n        if (!this.hasContentId) {\n          this.saveMessage = \"No content ID available. Cannot save.\";\n          this.saveStatus = \"error\";\n          return;\n        }\n\n        this.saveLoading = true;\n        this.saveMessage = null;\n\n        const response = await axios.put(\n          `${this.apiEndpoint}/content/contents/${this.contentId}`,\n          {\n            generatedContent: this.content,\n          }\n        );\n\n        if (response.data.success) {\n          this.saveMessage = \"Content saved successfully!\";\n          this.saveStatus = \"success\";\n          // Emit event to update parent content\n          this.$emit(\"update:content\", this.content);\n        } else {\n          throw new Error(response.data.error || \"Unknown error occurred\");\n        }\n      } catch (error) {\n        console.error(\"Error saving content:\", error);\n        this.saveMessage = \"Failed to save content: \" + error.message;\n        this.saveStatus = \"error\";\n      } finally {\n        this.saveLoading = false;\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    exportContent() {\n      try {\n        // Tạo dữ liệu để export\n        const exportData = {\n          title: this.projectTitle || \"Untitled Content\",\n          content: this.content,\n          image: this.imageUrl,\n          createdAt: new Date().toISOString(),\n          projectInfo: {\n            id: this.projectId,\n            title: this.projectTitle,\n            description: this.projectDescription,\n          },\n        };\n\n        // Tạo JSON string\n        const dataStr = JSON.stringify(exportData, null, 2);\n\n        // Tạo blob để download\n        const blob = new Blob([dataStr], { type: \"application/json\" });\n        const url = URL.createObjectURL(blob);\n\n        // Tạo link và kích hoạt download\n        const a = document.createElement(\"a\");\n        a.download = `${this.projectTitle || \"content\"}_export.json`;\n        a.href = url;\n        a.click();\n\n        // Giải phóng URL object\n        URL.revokeObjectURL(url);\n\n        this.saveMessage = \"Content exported successfully!\";\n        this.saveStatus = \"success\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      } catch (error) {\n        console.error(\"Error exporting content:\", error);\n        this.saveMessage = \"Failed to export content: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    shareContent() {\n      // Xử lý chia sẻ nội dung - có thể thông qua email hoặc mạng xã hội\n      try {\n        // Kiểm tra nếu Web Share API được hỗ trợ\n        if (navigator.share) {\n          navigator\n            .share({\n              title: this.projectTitle || \"My Content\",\n              text: `Check out my content: ${this.projectTitle || \"Content\"}`,\n              url: window.location.href,\n            })\n            .then(() => {\n              this.saveMessage = \"Content shared successfully!\";\n              this.saveStatus = \"success\";\n            })\n            .catch((error) => {\n              throw error;\n            });\n        } else {\n          // Fallback - copy URL vào clipboard\n          navigator.clipboard.writeText(window.location.href).then(() => {\n            this.saveMessage = \"URL copied to clipboard!\";\n            this.saveStatus = \"success\";\n          });\n        }\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      } catch (error) {\n        console.error(\"Error sharing content:\", error);\n        this.saveMessage = \"Failed to share content: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    downloadPDF() {\n      try {\n        // Thông báo cho người dùng rằng chức năng đang được phát triển\n        this.saveMessage = \"PDF download feature will be available soon.\";\n        this.saveStatus = \"success\";\n\n        // Xóa thông báo sau 3 giây\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n\n        // NOTE: Chức năng này sẽ được triển khai trong bản cập nhật tới\n        // Sử dụng thư viện như jsPDF hoặc html2pdf.js để tạo PDF từ nội dung\n      } catch (error) {\n        console.error(\"Error downloading PDF:\", error);\n        this.saveMessage = \"Failed to download PDF: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    goToDashboard() {\n      this.$emit(\"go-to-dashboard\");\n    },\n    async generateImageForContent() {\n      try {\n        this.imageLoading = true;\n        this.imageError = null;\n\n        // Hiển thị thông báo đang xử lý\n        this.showToast(\"Đang chuẩn bị tạo hình ảnh cho nội dung...\", \"info\");\n\n        if (!this.contentId) {\n          throw new Error(\"Không có ID nội dung để tạo hình ảnh\");\n        }\n\n        // Kiểm tra xem có nội dung không\n        if (!this.content || this.content.trim().length === 0) {\n          this.showToast(\"Không thể tạo hình ảnh: Nội dung trống\", \"error\");\n          throw new Error(\"Nội dung trống, không thể tạo hình ảnh\");\n        }\n\n        console.log(`Generating image for content ID: ${this.contentId}`);\n        console.log(`Content length: ${this.content.length} characters`);\n\n        // Bước 1: Tạo prompt từ nội dung\n        console.log(\"Step 1: Generating prompt from content\");\n        const promptResponse = await axios.post(\n          `/api/content/contents/generate-prompt`,\n          {\n            contentId: this.contentId,\n            style: \"Realistic\",\n            template: `Generate a [STYLE] image of [SUBJECT], featuring [KEY DETAILS]. Style: [ART STYLE/MEDIUM], color palette: [COLORS], lighting: [LIGHTING], composition: [COMPOSITION]. Additional effects: [EFFECTS]. Keep the overall mood [MOOD]. Render in Kandinsky 2.2 with high detail, resolution [RESOLUTION].`,\n            content: this.content,\n          },\n          {\n            timeout: 45000, // 45 seconds timeout for prompt generation\n          }\n        );\n\n        if (!promptResponse.data.success) {\n          throw new Error(\n            promptResponse.data.error || \"Lỗi khi tạo mô tả hình ảnh\"\n          );\n        }\n\n        const generatedPrompt = promptResponse.data.prompt;\n        console.log(\n          \"Generated prompt:\",\n          generatedPrompt.substring(0, 100) + \"...\"\n        );\n\n        // Hiển thị thông báo prompt đã được tạo\n        this.showToast(\n          \"Đã tạo mô tả hình ảnh, đang tạo hình ảnh...\",\n          \"success\"\n        );\n\n        // Bước 2: Tạo hình ảnh từ prompt\n        const imageResponse = await axios.post(\n          `/api/image/generate`,\n          {\n            prompt: generatedPrompt,\n            style: \"Realistic\",\n            width: 512,\n            height: 512,\n            num_inference_steps: 30,\n          },\n          {\n            timeout: 180000, // 3 minutes timeout for image generation\n          }\n        );\n\n        if (!imageResponse.data.success) {\n          throw new Error(\n            imageResponse.data.error || \"Lỗi khi tạo hình ảnh từ mô tả\"\n          );\n        }\n\n        const imageUrl = `/api/content/contents/${this.contentId}/images/${imageResponse.data.filename}`;\n\n        // Bước 3: Cập nhật URL hình ảnh vào nội dung\n        const updateResponse = await axios.put(\n          `/api/content/contents/${this.contentId}`,\n          { imageUrl }\n        );\n\n        if (!updateResponse.data.success) {\n          throw new Error(\n            updateResponse.data.error || \"Lỗi khi cập nhật URL hình ảnh\"\n          );\n        }\n\n        // Cập nhật URL hình ảnh vào local state\n        this.localImage = imageUrl;\n        this.$emit(\"update:image\", imageUrl);\n\n        // Hiển thị thông báo thành công\n        this.showToast(\"Đã tạo hình ảnh thành công!\", \"success\");\n      } catch (error) {\n        console.error(\"Error generating image for content:\", error);\n\n        let errorMessage = \"Lỗi không xác định\";\n\n        // Check for API response error\n        if (error.response) {\n          console.log(\"API response error:\", error.response.data);\n\n          // Handle specific error messages from server\n          if (error.response.data && error.response.data.error) {\n            errorMessage = error.response.data.error;\n\n            // Specific checks for common errors\n            if (errorMessage.includes(\"Missing required field\")) {\n              errorMessage =\n                \"Thiếu trường dữ liệu cần thiết. Vui lòng thử lại.\";\n              console.log(\"Content availability:\", !!this.content);\n              console.log(\"ContentId availability:\", !!this.contentId);\n\n              // Try retrieving the content again if missing\n              if (\n                this.contentId &&\n                (!this.content || this.content.trim().length === 0)\n              ) {\n                this.showToast(\"Đang thử tải lại nội dung...\", \"info\");\n                try {\n                  const contentResponse = await axios.get(\n                    `/api/content/contents/${this.contentId}`\n                  );\n                  if (\n                    contentResponse.data.success &&\n                    contentResponse.data.data.generatedContent\n                  ) {\n                    // Update the local content\n                    this.$emit(\n                      \"update:content\",\n                      contentResponse.data.data.generatedContent\n                    );\n                    this.showToast(\n                      \"Đã tải lại nội dung, vui lòng thử lại\",\n                      \"info\"\n                    );\n                  }\n                } catch (reloadError) {\n                  console.error(\"Error reloading content:\", reloadError);\n                }\n              }\n            }\n          }\n        } else if (error.message) {\n          errorMessage = error.message;\n        }\n\n        this.imageError = `Lỗi khi tạo hình ảnh: ${errorMessage}`;\n\n        // Hiển thị thông báo lỗi\n        this.showToast(`Lỗi: ${errorMessage}`, \"error\");\n\n        // Nếu lỗi do timeout\n        if (error.message.includes(\"timeout\")) {\n          this.showToast(\n            \"Quá thời gian chờ phản hồi. Vui lòng thử lại sau.\",\n            \"error\"\n          );\n        }\n      } finally {\n        this.imageLoading = false;\n      }\n    },\n    showToast(message, type = \"info\") {\n      if (!this.toasts) this.toasts = [];\n\n      const id = Date.now();\n      this.toasts.push({ id, message, type });\n\n      // Tự động xóa sau 5 giây\n      setTimeout(() => {\n        this.removeToast(id);\n      }, 5000);\n    },\n    removeToast(id) {\n      if (this.toasts) {\n        this.toasts = this.toasts.filter((toast) => toast.id !== id);\n      }\n    },\n    ensureAbsoluteUrl(url) {\n      if (!url) return null;\n\n      // Hiển thị URL trong console để debug\n      console.log(`Trying to resolve URL: ${url}`);\n\n      // Nếu đã là URL tuyệt đối hoặc data URL, giữ nguyên\n      if (\n        url.startsWith(\"http://\") ||\n        url.startsWith(\"https://\") ||\n        url.startsWith(\"data:\")\n      ) {\n        console.log(`URL is already absolute: ${url}`);\n        return url;\n      }\n\n      // Xử lý đặc biệt cho thư mục uploads - Được cập nhật để phù hợp với route thực tế\n      if (url.includes(\"uploads/\")) {\n        // Lấy tên file từ đường dẫn\n        const filename = url.split(\"/\").pop();\n        // Đảm bảo sử dụng đúng endpoint /api/image/uploads/:fileName\n        const result = `${window.location.origin}/api/image/uploads/${filename}`;\n        console.log(`Resolved uploads URL to: ${result}`);\n        return result;\n      }\n\n      // Nếu bắt đầu với /api, thêm domain\n      if (url.startsWith(\"/api\")) {\n        const result = `${window.location.origin}${url}`;\n        console.log(`Resolved API URL to: ${result}`);\n        return result;\n      }\n\n      // Nếu bắt đầu với server/ hoặc /server/\n      if (url.startsWith(\"server/\") || url.startsWith(\"/server/\")) {\n        const result = `${window.location.origin}/api/${url.replace(\n          /^(\\/)?server\\//,\n          \"\"\n        )}`;\n        console.log(`Resolved server path to: ${result}`);\n        return result;\n      }\n\n      // Nếu không bắt đầu với / nhưng vẫn là đường dẫn tương đối, thêm /\n      if (!url.startsWith(\"/\")) {\n        const result = `${window.location.origin}/${url}`;\n        console.log(`Resolved relative path to: ${result}`);\n        return result;\n      }\n\n      // Trường hợp còn lại, giả định là URL tương đối với gốc\n      const result = `${window.location.origin}${url}`;\n      console.log(`Resolved root-relative URL to: ${result}`);\n      return result;\n    },\n    handleImageError(event) {\n      console.error(\"Image loading error:\", event);\n      this.imageError = \"Failed to load image\";\n\n      // Try to debug and fix the image URL\n      if (this.localImage) {\n        this.debugImageUrl(this.localImage);\n      } else if (this.generatedImage) {\n        this.debugImageUrl(this.generatedImage);\n      }\n    },\n    debugImageUrl(originalUrl) {\n      console.log(\"Debugging image URL:\", originalUrl);\n\n      // Kiểm tra nhiều định dạng URL khác nhau\n      const possibleUrls = [];\n\n      if (typeof originalUrl !== \"string\") {\n        console.error(\"Original URL is not a string:\", originalUrl);\n        return;\n      }\n\n      // Lấy tên tệp nếu có\n      const filename = originalUrl.split(\"/\").pop();\n      console.log(\"Extracted filename:\", filename);\n\n      // Đường dẫn trực tiếp đến API endpoint (ưu tiên cao nhất)\n      if (filename) {\n        possibleUrls.push(`/api/image/uploads/${filename}`);\n        possibleUrls.push(\n          `${window.location.origin}/api/image/uploads/${filename}`\n        );\n      }\n\n      if (originalUrl.includes(\"uploads/\")) {\n        // Các định dạng khác cũng được thử\n        possibleUrls.push(`/server/uploads/${filename}`);\n        possibleUrls.push(`/uploads/${filename}`);\n      }\n\n      // Thử URL gốc với tên miền\n      if (!originalUrl.startsWith(\"http\") && !originalUrl.startsWith(\"data:\")) {\n        possibleUrls.push(\n          `${window.location.origin}${\n            originalUrl.startsWith(\"/\") ? \"\" : \"/\"\n          }${originalUrl}`\n        );\n      }\n\n      // Thêm URL gốc vào danh sách (nếu chưa có)\n      if (!possibleUrls.includes(originalUrl)) {\n        possibleUrls.push(originalUrl);\n      }\n\n      console.log(\"Trying alternate URLs:\", possibleUrls);\n\n      // Thử tải mỗi URL\n      let successFound = false;\n\n      possibleUrls.forEach((url, index) => {\n        setTimeout(() => {\n          // Skip if we already found a working URL\n          if (successFound) return;\n\n          const img = new Image();\n          img.onload = () => {\n            console.log(`Success with URL: ${url}`);\n            successFound = true;\n            this.localImage = url;\n            this.$emit(\"update:image\", url);\n            this.imageError = null;\n            this.imageLoading = false;\n          };\n          img.onerror = () => {\n            console.log(`Failed with URL: ${url}`);\n\n            // Nếu đây là URL cuối cùng và tất cả đều thất bại, hiển thị nút tạo hình ảnh mới\n            if (index === possibleUrls.length - 1 && !successFound) {\n              console.log(\"All URLs failed, showing generate button\");\n              this.imageError =\n                \"Không thể tải hình ảnh. Bạn có thể tạo hình ảnh mới.\";\n            }\n          };\n          img.src = url;\n        }, index * 100);\n      });\n    },\n    handleImageLoad() {\n      console.log(\"Image loaded successfully\");\n      this.imageError = null;\n    },\n  },\n  watch: {\n    generatedImage: {\n      immediate: true,\n      handler(newValue, oldValue) {\n        if (newValue !== oldValue) {\n          console.log(\"generatedImage changed:\", newValue);\n\n          // If we get a new generatedImage value, update localImage\n          if (newValue) {\n            this.localImage = newValue;\n          }\n          // Don't clear localImage if newValue is null - we may already have a valid image\n          // from fetchContentImage\n        }\n      },\n    },\n    contentId: {\n      immediate: true,\n      handler(newValue, oldValue) {\n        if (newValue && newValue !== oldValue) {\n          console.log(\"Content ID changed from\", oldValue, \"to\", newValue);\n\n          // Only clear localImage if we're switching to a different content\n          if (oldValue) {\n            this.localImage = null;\n          }\n\n          // Always fetch the image when contentId changes\n          this.fetchContentImage();\n        }\n      },\n    },\n  },\n};\n</script>\n\n<style scoped>\n.step-content {\n  background: white;\n  border-radius: 12px;\n  padding: 2rem;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n\nh2 {\n  color: #1c1c4c;\n  margin-bottom: 1.5rem;\n  text-align: center;\n  font-weight: 600;\n}\n\n.project-info {\n  background: #f8f9fa;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 2rem;\n}\n\n.project-info h3 {\n  color: #1c1c4c;\n  margin: 0 0 0.5rem 0;\n}\n\n.project-info p {\n  color: #6c757d;\n  margin: 0 0 1rem 0;\n}\n\n.project-status {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: 0.5rem;\n}\n\n.status-badge {\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-weight: bold;\n}\n\n.status-badge.in_progress {\n  background-color: #ecedf7;\n  color: #1c1c4c;\n}\n\n.status-badge.finished {\n  background-color: #e8f5e9;\n  color: #28a745;\n}\n\n.status-button {\n  background: transparent;\n  border: 1px solid #1c1c4c;\n  color: #1c1c4c;\n  padding: 0.25rem 0.75rem;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.8rem;\n  transition: all 0.3s ease;\n}\n\n.status-button:hover {\n  background: #ecedf7;\n}\n\n.final-content {\n  display: grid;\n  gap: 2rem;\n  margin-bottom: 2rem;\n}\n\n.final-content h3 {\n  margin-bottom: 1rem;\n  color: #1c1c4c;\n  font-weight: 600;\n}\n\n.content-box {\n  white-space: pre-wrap;\n  line-height: 1.6;\n  font-family: \"Arial\", sans-serif;\n  padding: 1.5rem;\n  background: white;\n  border-radius: 8px;\n  border: 1px solid #e9ecef;\n  max-height: 400px;\n  overflow-y: auto;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n}\n\n.content-box p {\n  margin-bottom: 1rem;\n}\n\n.content-box h1,\n.content-box h2,\n.content-box h3,\n.content-box h4,\n.content-box h5,\n.content-box h6 {\n  margin-top: 1.5rem;\n  margin-bottom: 1rem;\n  color: #1c1c4c;\n}\n\n.final-image-section {\n  background: #f8f9fa;\n  border-radius: 8px;\n  padding: 2rem;\n  margin-bottom: 2rem;\n}\n\n.final-image-section h3 {\n  margin-bottom: 1.5rem;\n  color: #1c1c4c;\n  font-weight: 600;\n}\n\n.image-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.image-loading {\n  width: 100%;\n  height: 200px;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.loading-text {\n  color: #6c757d;\n  font-size: 0.9rem;\n  text-align: center;\n}\n\n.image-section img {\n  max-width: 100%;\n  max-height: 300px;\n  object-fit: contain;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.no-image-placeholder {\n  width: 100%;\n  height: 200px;\n  background: #e9ecef;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  color: #6c757d;\n  font-style: italic;\n  padding: 1rem;\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.no-image-placeholder p {\n  margin-top: 0.5rem;\n  font-size: 0.9rem;\n}\n\n.image-actions {\n  margin-top: 1rem;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n\n.final-actions {\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n}\n\n.additional-actions {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n  justify-content: center;\n}\n\n.navigation-buttons {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  justify-content: center;\n}\n\n.action-buttons {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n  justify-content: center;\n}\n\n.btn {\n  min-width: 120px;\n  text-align: center;\n  padding: 0.75rem 1.25rem;\n  border-radius: 6px;\n  font-size: 0.9rem;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n}\n\n.btn-primary {\n  background: #1c1c4c;\n  color: white;\n  border: none;\n}\n\n.btn-primary:hover {\n  background: #2a2a6c;\n}\n\n.btn-outline-primary {\n  background: transparent;\n  border: 1px solid #1c1c4c;\n  color: #1c1c4c;\n}\n\n.btn-outline-primary:hover {\n  background: #ecedf7;\n}\n\n.btn-light {\n  background: white;\n  color: #1c1c4c;\n  border: 1px solid #1c1c4c;\n}\n\n.btn-light:hover {\n  background: #f8f9fa;\n}\n\n.btn-info {\n  background: white;\n  color: #1c1c4c;\n  border: 1px solid #1c1c4c;\n}\n\n.btn-info:hover {\n  background: #f8f9fa;\n}\n\n.btn-success {\n  background: #1c1c4c;\n  color: white;\n  border: none;\n}\n\n.btn-success:hover {\n  background: #2a2a6c;\n}\n\n.error-message {\n  color: #dc3545;\n  font-size: 0.9rem;\n  margin-top: 0.5rem;\n}\n\n.project-info.warning {\n  background-color: #fff3cd;\n  border: 1px solid #ffeeba;\n  color: #856404;\n}\n\n.status-button:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.save-message {\n  margin-top: 1rem;\n  padding: 0.75rem;\n  border-radius: 4px;\n  text-align: center;\n  font-size: 0.9rem;\n}\n\n.save-message.success {\n  background-color: #e8f5e9;\n  color: #2e7d32;\n}\n\n.save-message.error {\n  background-color: #ffebee;\n  color: #c62828;\n}\n\n@media (max-width: 768px) {\n  .action-buttons,\n  .navigation-buttons,\n  .additional-actions {\n    flex-direction: column;\n    width: 100%;\n  }\n\n  .action-buttons button,\n  .navigation-buttons button,\n  .additional-actions button {\n    width: 100%;\n    margin-bottom: 0.5rem;\n  }\n\n  .btn {\n    width: 100%;\n  }\n}\n\n/* Toast Styles */\n.toast-container {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  z-index: 1000;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  max-width: 350px;\n}\n\n.toast-message {\n  padding: 12px 16px;\n  border-radius: 6px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  animation: slide-in 0.3s ease-out forwards;\n  cursor: pointer;\n  color: white;\n}\n\n.toast-success {\n  background-color: #42b983;\n}\n\n.toast-error {\n  background-color: #e74c3c;\n}\n\n.toast-info {\n  background-color: #3498db;\n}\n\n.toast-close-btn {\n  background: none;\n  border: none;\n  color: white;\n  font-size: 20px;\n  cursor: pointer;\n  margin-left: 8px;\n  opacity: 0.7;\n}\n\n.toast-close-btn:hover {\n  opacity: 1;\n}\n\n@keyframes slide-in {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}