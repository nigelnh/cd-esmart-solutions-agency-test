{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from \"axios\";\nexport default {\n  name: \"FinalStep\",\n  props: {\n    content: {\n      type: String,\n      required: true\n    },\n    generatedImage: {\n      type: String,\n      default: null\n    },\n    projectId: {\n      type: String,\n      default: \"\"\n    },\n    projectTitle: {\n      type: String,\n      default: \"Content Project\"\n    },\n    projectDescription: {\n      type: String,\n      default: \"\"\n    },\n    contentId: {\n      type: String,\n      default: \"\"\n    }\n  },\n  data() {\n    return {\n      projectStatus: \"in_progress\",\n      loading: false,\n      error: null,\n      saveLoading: false,\n      saveMessage: null,\n      saveStatus: \"success\",\n      imageLoading: false,\n      imageError: null,\n      localImage: this.generatedImage,\n      toastObj: {\n        show: false,\n        message: \"\",\n        type: \"info\",\n        // 'info', 'success', 'error'\n        timeout: null\n      }\n    };\n  },\n  computed: {\n    apiEndpoint() {\n      return process.env.VUE_APP_API_URL || \"http://localhost:3001/api\";\n    },\n    hasProjectId() {\n      return this.projectId && this.projectId.length > 0;\n    },\n    hasContentId() {\n      return this.contentId && this.contentId.length > 0;\n    },\n    formattedContent() {\n      if (!this.content) return \"\";\n\n      // Tạo định dạng HTML cho nội dung\n      const formatted = this.content\n      // Thay thế dòng trống bằng thẻ đoạn\n      .replace(/\\n\\s*\\n/g, \"</p><p>\")\n      // Thay thế dòng mới đơn bằng thẻ br\n      .replace(/\\n/g, \"<br>\")\n      // Bọc toàn bộ nội dung trong thẻ p\n      .replace(/^(.+)$/, \"<p>$1</p>\");\n      return formatted;\n    },\n    imageUrl() {\n      if (this.localImage) {\n        if (typeof this.localImage === \"string\") {\n          if (this.localImage.startsWith(\"data:\")) {\n            return this.localImage;\n          }\n          if (this.localImage.startsWith(\"http\") || this.localImage.startsWith(\"/\")) {\n            return this.localImage;\n          }\n        }\n        if (this.localImage.image) {\n          return this.localImage.image;\n        }\n      }\n      if (this.contentId && !this.localImage) {\n        this.fetchContentImage();\n      }\n      return null;\n    }\n  },\n  created() {\n    if (this.hasProjectId) {\n      this.fetchProjectStatus();\n    }\n\n    // Nếu có contentId nhưng không có hình ảnh, thử lấy hình ảnh từ server\n    if (this.hasContentId && !this.generatedImage) {\n      this.fetchContentImage();\n    }\n  },\n  methods: {\n    async fetchProjectStatus() {\n      try {\n        if (!this.hasProjectId) return;\n        const response = await axios.get(`${this.apiEndpoint}/projects/${this.projectId}`);\n        if (response.data.success) {\n          this.projectStatus = response.data.data.status;\n        }\n      } catch (error) {\n        console.error(\"Error fetching project status:\", error);\n        this.error = \"Could not fetch project status\";\n      }\n    },\n    async fetchContentImage() {\n      if (!this.contentId) return;\n      try {\n        this.imageLoading = true;\n        this.imageError = null;\n        console.log(`Fetching image for content ID: ${this.contentId}`);\n        const response = await fetch(`/api/content/contents/${this.contentId}`);\n        if (!response.ok) {\n          throw new Error(`Error fetching content: ${response.statusText}`);\n        }\n        const contentData = await response.json();\n        console.log(\"Content data received:\", contentData);\n        if (contentData.success && contentData.data && contentData.data.imageUrl) {\n          console.log(\"Found image URL:\", contentData.data.imageUrl);\n          this.localImage = contentData.data.imageUrl;\n          this.$emit(\"update:image\", contentData.data.imageUrl);\n        } else if (contentData.success && contentData.data) {\n          console.log(\"Content found but no image URL available\");\n          this.imageError = \"No image available for this content\";\n        }\n      } catch (error) {\n        console.error(\"Error fetching content image:\", error);\n        this.imageError = error.message;\n      } finally {\n        this.imageLoading = false;\n      }\n    },\n    async markAsFinished() {\n      try {\n        if (!this.hasProjectId) {\n          alert(\"Cannot update status: No project ID available\");\n          return;\n        }\n        this.loading = true;\n        const response = await axios.patch(`${this.apiEndpoint}/projects/${this.projectId}/status`, {\n          status: \"finished\"\n        });\n        if (response.data.success) {\n          this.projectStatus = \"finished\";\n        }\n      } catch (error) {\n        console.error(\"Error updating project status:\", error);\n        alert(\"Failed to update project status: \" + error.message);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async markAsInProgress() {\n      try {\n        if (!this.hasProjectId) {\n          alert(\"Cannot update status: No project ID available\");\n          return;\n        }\n        this.loading = true;\n        const response = await axios.patch(`${this.apiEndpoint}/projects/${this.projectId}/status`, {\n          status: \"in_progress\"\n        });\n        if (response.data.success) {\n          this.projectStatus = \"in_progress\";\n        }\n      } catch (error) {\n        console.error(\"Error updating project status:\", error);\n        alert(\"Failed to update project status: \" + error.message);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async saveContent() {\n      try {\n        if (!this.hasContentId) {\n          this.saveMessage = \"No content ID available. Cannot save.\";\n          this.saveStatus = \"error\";\n          return;\n        }\n        this.saveLoading = true;\n        this.saveMessage = null;\n        const response = await axios.put(`${this.apiEndpoint}/content/contents/${this.contentId}`, {\n          generatedContent: this.content\n        });\n        if (response.data.success) {\n          this.saveMessage = \"Content saved successfully!\";\n          this.saveStatus = \"success\";\n        } else {\n          throw new Error(response.data.error || \"Unknown error occurred\");\n        }\n      } catch (error) {\n        console.error(\"Error saving content:\", error);\n        this.saveMessage = \"Failed to save content: \" + error.message;\n        this.saveStatus = \"error\";\n      } finally {\n        this.saveLoading = false;\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    exportContent() {\n      try {\n        // Tạo dữ liệu để export\n        const exportData = {\n          title: this.projectTitle || \"Untitled Content\",\n          content: this.content,\n          image: this.imageUrl,\n          createdAt: new Date().toISOString(),\n          projectInfo: {\n            id: this.projectId,\n            title: this.projectTitle,\n            description: this.projectDescription\n          }\n        };\n\n        // Tạo JSON string\n        const dataStr = JSON.stringify(exportData, null, 2);\n\n        // Tạo blob để download\n        const blob = new Blob([dataStr], {\n          type: \"application/json\"\n        });\n        const url = URL.createObjectURL(blob);\n\n        // Tạo link và kích hoạt download\n        const a = document.createElement(\"a\");\n        a.download = `${this.projectTitle || \"content\"}_export.json`;\n        a.href = url;\n        a.click();\n\n        // Giải phóng URL object\n        URL.revokeObjectURL(url);\n        this.saveMessage = \"Content exported successfully!\";\n        this.saveStatus = \"success\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      } catch (error) {\n        console.error(\"Error exporting content:\", error);\n        this.saveMessage = \"Failed to export content: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    shareContent() {\n      // Xử lý chia sẻ nội dung - có thể thông qua email hoặc mạng xã hội\n      try {\n        // Kiểm tra nếu Web Share API được hỗ trợ\n        if (navigator.share) {\n          navigator.share({\n            title: this.projectTitle || \"My Content\",\n            text: `Check out my content: ${this.projectTitle || \"Content\"}`,\n            url: window.location.href\n          }).then(() => {\n            this.saveMessage = \"Content shared successfully!\";\n            this.saveStatus = \"success\";\n          }).catch(error => {\n            throw error;\n          });\n        } else {\n          // Fallback - copy URL vào clipboard\n          navigator.clipboard.writeText(window.location.href).then(() => {\n            this.saveMessage = \"URL copied to clipboard!\";\n            this.saveStatus = \"success\";\n          });\n        }\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      } catch (error) {\n        console.error(\"Error sharing content:\", error);\n        this.saveMessage = \"Failed to share content: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    downloadPDF() {\n      try {\n        // Thông báo cho người dùng rằng chức năng đang được phát triển\n        this.saveMessage = \"PDF download feature will be available soon.\";\n        this.saveStatus = \"success\";\n\n        // Xóa thông báo sau 3 giây\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n\n        // NOTE: Chức năng này sẽ được triển khai trong bản cập nhật tới\n        // Sử dụng thư viện như jsPDF hoặc html2pdf.js để tạo PDF từ nội dung\n      } catch (error) {\n        console.error(\"Error downloading PDF:\", error);\n        this.saveMessage = \"Failed to download PDF: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    goToDashboard() {\n      this.$emit(\"go-to-dashboard\");\n    },\n    async generateImageForContent() {\n      if (!this.contentId) return;\n      try {\n        this.imageLoading = true;\n        this.imageError = null;\n        console.log(`Generating image for content ID: ${this.contentId}`);\n\n        // Timeout 3 phút (180000ms)\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), 180000);\n        try {\n          const response = await fetch(`/api/content/contents/${this.contentId}/generate-image`, {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              style: \"Realistic\"\n            }),\n            signal: controller.signal\n          });\n\n          // Xoá timeout nếu request thành công\n          clearTimeout(timeoutId);\n          if (!response.ok) {\n            throw new Error(`Error generating image: ${response.statusText}`);\n          }\n          const data = await response.json();\n          console.log(\"Image generation response:\", data);\n          if (data.success && data.data && data.data.imageUrl) {\n            console.log(\"New image URL:\", data.data.imageUrl);\n            this.localImage = data.data.imageUrl;\n            this.$emit(\"update:image\", data.data.imageUrl);\n            this.showToast(\"Image generated successfully\", \"success\");\n          } else {\n            throw new Error(\"Image generation did not return a valid URL\");\n          }\n        } catch (requestError) {\n          clearTimeout(timeoutId);\n          if (requestError.name === \"AbortError\") {\n            throw new Error(\"Request timeout: Image generation is taking too long\");\n          }\n          throw requestError;\n        }\n      } catch (error) {\n        console.error(\"Error generating image for content:\", error);\n        this.imageError = error.message;\n\n        // Kiểm tra nếu lỗi liên quan đến FastAPI service\n        if (error.message.includes(\"Failed to fetch\") || error.message.includes(\"NetworkError\") || error.message.includes(\"timeout\") || error.message.includes(\"ECONNREFUSED\")) {\n          this.showToast(\"Error connecting to image generation service. Please make sure the service is running at http://localhost:8000\", \"error\");\n        } else {\n          this.showToast(`Error generating image: ${error.message}`, \"error\");\n        }\n      } finally {\n        this.imageLoading = false;\n      }\n    },\n    showToast(message, type = \"info\") {\n      // Clear any existing timeout\n      if (this.toastObj.timeout) {\n        clearTimeout(this.toastObj.timeout);\n      }\n\n      // Set toast properties\n      this.toastObj.show = true;\n      this.toastObj.message = message;\n      this.toastObj.type = type;\n\n      // Auto hide after 5 seconds\n      this.toastObj.timeout = setTimeout(() => {\n        this.toastObj.show = false;\n      }, 5000);\n\n      // Log for debugging\n      console.log(`Toast: ${type} - ${message}`);\n    }\n  },\n  watch: {\n    generatedImage: {\n      immediate: true,\n      handler(newValue) {\n        this.localImage = newValue;\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","name","props","content","type","String","required","generatedImage","default","projectId","projectTitle","projectDescription","contentId","data","projectStatus","loading","error","saveLoading","saveMessage","saveStatus","imageLoading","imageError","localImage","toastObj","show","message","timeout","computed","apiEndpoint","process","env","VUE_APP_API_URL","hasProjectId","length","hasContentId","formattedContent","formatted","replace","imageUrl","startsWith","image","fetchContentImage","created","fetchProjectStatus","methods","response","get","success","status","console","log","fetch","ok","Error","statusText","contentData","json","$emit","markAsFinished","alert","patch","markAsInProgress","saveContent","put","generatedContent","setTimeout","exportContent","exportData","title","createdAt","Date","toISOString","projectInfo","id","description","dataStr","JSON","stringify","blob","Blob","url","URL","createObjectURL","a","document","createElement","download","href","click","revokeObjectURL","shareContent","navigator","share","text","window","location","then","catch","clipboard","writeText","downloadPDF","goToDashboard","generateImageForContent","controller","AbortController","timeoutId","abort","method","headers","body","style","signal","clearTimeout","showToast","requestError","includes","watch","immediate","handler","newValue"],"sources":["/Users/nhannguyen/Desktop/Duan/esmart-solutions-agency/src/components/creator-ai/FinalStep.vue"],"sourcesContent":["<template>\n  <div class=\"step-content\">\n    <h2>{{ $t(\"creatorAI.final.title\") }}</h2>\n    <div v-if=\"hasProjectId\" class=\"project-info\">\n      <h3>{{ projectTitle }}</h3>\n      <p v-if=\"projectDescription\">{{ projectDescription }}</p>\n      <div class=\"project-status\">\n        <span :class=\"['status-badge', projectStatus]\">\n          {{ projectStatus === \"in_progress\" ? \"In Progress\" : \"Finished\" }}\n        </span>\n        <button\n          v-if=\"projectStatus === 'in_progress'\"\n          class=\"status-button\"\n          @click=\"markAsFinished\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? \"Updating...\" : \"Mark as Finished\" }}\n        </button>\n        <button\n          v-else\n          class=\"status-button\"\n          @click=\"markAsInProgress\"\n          :disabled=\"loading\"\n        >\n          {{ loading ? \"Updating...\" : \"Mark as In Progress\" }}\n        </button>\n      </div>\n      <p v-if=\"error\" class=\"error-message\">{{ error }}</p>\n    </div>\n    <div v-else class=\"project-info warning\">\n      <p>\n        This content is not saved to a project. Create a new project to save\n        your work.\n      </p>\n    </div>\n    <div class=\"final-content\">\n      <h3 class=\"mb-3\">{{ $t(\"Generated Content\") }}</h3>\n      <div v-if=\"loading\" class=\"d-flex justify-content-center\">\n        <div class=\"spinner-border text-primary\" role=\"status\">\n          <span class=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n      <div v-else class=\"content-box\" v-html=\"formattedContent\"></div>\n    </div>\n\n    <div class=\"final-image-section\">\n      <h3>{{ $t(\"creatorAI.final.imageSection\") }}</h3>\n      <div class=\"image-section\">\n        <div\n          v-if=\"imageLoading\"\n          class=\"d-flex justify-content-center align-items-center\"\n          style=\"height: 200px\"\n        >\n          <div class=\"spinner-border text-primary\" role=\"status\">\n            <span class=\"visually-hidden\">Loading...</span>\n          </div>\n        </div>\n        <div v-else-if=\"imageError\" class=\"no-image-placeholder\">\n          <i class=\"fa-solid fa-triangle-exclamation fa-3x\"></i>\n          <p>{{ imageError }}</p>\n        </div>\n        <img\n          v-else-if=\"imageUrl\"\n          :src=\"imageUrl\"\n          alt=\"Generated image\"\n          class=\"img-fluid rounded mb-3\"\n        />\n        <div v-else class=\"no-image-placeholder\">\n          <i class=\"fa-solid fa-image fa-5x\"></i>\n          <p>No image available</p>\n        </div>\n\n        <div class=\"image-actions\">\n          <button\n            v-if=\"!imageLoading && !imageUrl && contentId\"\n            class=\"btn btn-success mt-2\"\n            @click=\"generateImageForContent\"\n          >\n            <i class=\"fas fa-magic me-1\"></i>\n            {{ $t(\"creatorAI.final.generateImage\") || \"Generate Image\" }}\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"final-actions\">\n      <div class=\"action-buttons\">\n        <div class=\"additional-actions\">\n          <button class=\"btn btn-outline-primary\" @click=\"exportContent\">\n            <i class=\"fas fa-file-export me-1\"></i>\n            {{ $t(\"creatorAI.final.export\") || \"Export\" }}\n          </button>\n          <button class=\"btn btn-outline-primary\" @click=\"shareContent\">\n            <i class=\"fas fa-share-alt me-1\"></i>\n            {{ $t(\"creatorAI.final.share\") || \"Share\" }}\n          </button>\n          <button class=\"btn btn-outline-primary\" @click=\"downloadPDF\">\n            <i class=\"fas fa-file-pdf me-1\"></i>\n            {{ $t(\"creatorAI.final.downloadPDF\") || \"Download PDF\" }}\n          </button>\n        </div>\n      </div>\n      <div class=\"navigation-buttons\">\n        <button class=\"btn btn-light\" @click=\"$emit('prev')\">\n          <i class=\"fas fa-arrow-left me-1\"></i>\n          {{ $t(\"creatorAI.common.previousStep\") || \"Previous Step\" }}\n        </button>\n        <button class=\"btn btn-info\" @click=\"$emit('go-to-dashboard')\">\n          <i class=\"fas fa-home me-1\"></i>\n          {{ $t(\"creatorAI.common.dashboard\") || \"Dashboard\" }}\n        </button>\n        <button class=\"btn btn-success\" @click=\"$emit('create-new')\">\n          <i class=\"fas fa-plus me-1\"></i>\n          {{ $t(\"creatorAI.common.createNew\") || \"Create New\" }}\n        </button>\n      </div>\n    </div>\n    <div v-if=\"saveMessage\" :class=\"['save-message', saveStatus]\">\n      {{ saveMessage }}\n    </div>\n\n    <!-- Toast Message Container -->\n    <div v-if=\"toastObj.show\" class=\"toast-container\" :class=\"toastObj.type\">\n      <div class=\"toast-content\">\n        <i\n          v-if=\"toastObj.type === 'success'\"\n          class=\"fas fa-check-circle toast-icon\"\n        ></i>\n        <i\n          v-else-if=\"toastObj.type === 'error'\"\n          class=\"fas fa-exclamation-circle toast-icon\"\n        ></i>\n        <i v-else class=\"fas fa-info-circle toast-icon\"></i>\n        <div class=\"toast-message\">{{ toastObj.message }}</div>\n      </div>\n      <button @click=\"toastObj.show = false\" class=\"toast-close\">\n        &times;\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"FinalStep\",\n  props: {\n    content: {\n      type: String,\n      required: true,\n    },\n    generatedImage: {\n      type: String,\n      default: null,\n    },\n    projectId: {\n      type: String,\n      default: \"\",\n    },\n    projectTitle: {\n      type: String,\n      default: \"Content Project\",\n    },\n    projectDescription: {\n      type: String,\n      default: \"\",\n    },\n    contentId: {\n      type: String,\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      projectStatus: \"in_progress\",\n      loading: false,\n      error: null,\n      saveLoading: false,\n      saveMessage: null,\n      saveStatus: \"success\",\n      imageLoading: false,\n      imageError: null,\n      localImage: this.generatedImage,\n      toastObj: {\n        show: false,\n        message: \"\",\n        type: \"info\", // 'info', 'success', 'error'\n        timeout: null,\n      },\n    };\n  },\n  computed: {\n    apiEndpoint() {\n      return process.env.VUE_APP_API_URL || \"http://localhost:3001/api\";\n    },\n    hasProjectId() {\n      return this.projectId && this.projectId.length > 0;\n    },\n    hasContentId() {\n      return this.contentId && this.contentId.length > 0;\n    },\n    formattedContent() {\n      if (!this.content) return \"\";\n\n      // Tạo định dạng HTML cho nội dung\n      const formatted = this.content\n        // Thay thế dòng trống bằng thẻ đoạn\n        .replace(/\\n\\s*\\n/g, \"</p><p>\")\n        // Thay thế dòng mới đơn bằng thẻ br\n        .replace(/\\n/g, \"<br>\")\n        // Bọc toàn bộ nội dung trong thẻ p\n        .replace(/^(.+)$/, \"<p>$1</p>\");\n\n      return formatted;\n    },\n    imageUrl() {\n      if (this.localImage) {\n        if (typeof this.localImage === \"string\") {\n          if (this.localImage.startsWith(\"data:\")) {\n            return this.localImage;\n          }\n\n          if (\n            this.localImage.startsWith(\"http\") ||\n            this.localImage.startsWith(\"/\")\n          ) {\n            return this.localImage;\n          }\n        }\n\n        if (this.localImage.image) {\n          return this.localImage.image;\n        }\n      }\n\n      if (this.contentId && !this.localImage) {\n        this.fetchContentImage();\n      }\n\n      return null;\n    },\n  },\n  created() {\n    if (this.hasProjectId) {\n      this.fetchProjectStatus();\n    }\n\n    // Nếu có contentId nhưng không có hình ảnh, thử lấy hình ảnh từ server\n    if (this.hasContentId && !this.generatedImage) {\n      this.fetchContentImage();\n    }\n  },\n  methods: {\n    async fetchProjectStatus() {\n      try {\n        if (!this.hasProjectId) return;\n\n        const response = await axios.get(\n          `${this.apiEndpoint}/projects/${this.projectId}`\n        );\n        if (response.data.success) {\n          this.projectStatus = response.data.data.status;\n        }\n      } catch (error) {\n        console.error(\"Error fetching project status:\", error);\n        this.error = \"Could not fetch project status\";\n      }\n    },\n    async fetchContentImage() {\n      if (!this.contentId) return;\n\n      try {\n        this.imageLoading = true;\n        this.imageError = null;\n\n        console.log(`Fetching image for content ID: ${this.contentId}`);\n        const response = await fetch(`/api/content/contents/${this.contentId}`);\n\n        if (!response.ok) {\n          throw new Error(`Error fetching content: ${response.statusText}`);\n        }\n\n        const contentData = await response.json();\n        console.log(\"Content data received:\", contentData);\n\n        if (\n          contentData.success &&\n          contentData.data &&\n          contentData.data.imageUrl\n        ) {\n          console.log(\"Found image URL:\", contentData.data.imageUrl);\n          this.localImage = contentData.data.imageUrl;\n          this.$emit(\"update:image\", contentData.data.imageUrl);\n        } else if (contentData.success && contentData.data) {\n          console.log(\"Content found but no image URL available\");\n          this.imageError = \"No image available for this content\";\n        }\n      } catch (error) {\n        console.error(\"Error fetching content image:\", error);\n        this.imageError = error.message;\n      } finally {\n        this.imageLoading = false;\n      }\n    },\n    async markAsFinished() {\n      try {\n        if (!this.hasProjectId) {\n          alert(\"Cannot update status: No project ID available\");\n          return;\n        }\n\n        this.loading = true;\n        const response = await axios.patch(\n          `${this.apiEndpoint}/projects/${this.projectId}/status`,\n          {\n            status: \"finished\",\n          }\n        );\n\n        if (response.data.success) {\n          this.projectStatus = \"finished\";\n        }\n      } catch (error) {\n        console.error(\"Error updating project status:\", error);\n        alert(\"Failed to update project status: \" + error.message);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async markAsInProgress() {\n      try {\n        if (!this.hasProjectId) {\n          alert(\"Cannot update status: No project ID available\");\n          return;\n        }\n\n        this.loading = true;\n        const response = await axios.patch(\n          `${this.apiEndpoint}/projects/${this.projectId}/status`,\n          {\n            status: \"in_progress\",\n          }\n        );\n\n        if (response.data.success) {\n          this.projectStatus = \"in_progress\";\n        }\n      } catch (error) {\n        console.error(\"Error updating project status:\", error);\n        alert(\"Failed to update project status: \" + error.message);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async saveContent() {\n      try {\n        if (!this.hasContentId) {\n          this.saveMessage = \"No content ID available. Cannot save.\";\n          this.saveStatus = \"error\";\n          return;\n        }\n\n        this.saveLoading = true;\n        this.saveMessage = null;\n\n        const response = await axios.put(\n          `${this.apiEndpoint}/content/contents/${this.contentId}`,\n          {\n            generatedContent: this.content,\n          }\n        );\n\n        if (response.data.success) {\n          this.saveMessage = \"Content saved successfully!\";\n          this.saveStatus = \"success\";\n        } else {\n          throw new Error(response.data.error || \"Unknown error occurred\");\n        }\n      } catch (error) {\n        console.error(\"Error saving content:\", error);\n        this.saveMessage = \"Failed to save content: \" + error.message;\n        this.saveStatus = \"error\";\n      } finally {\n        this.saveLoading = false;\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    exportContent() {\n      try {\n        // Tạo dữ liệu để export\n        const exportData = {\n          title: this.projectTitle || \"Untitled Content\",\n          content: this.content,\n          image: this.imageUrl,\n          createdAt: new Date().toISOString(),\n          projectInfo: {\n            id: this.projectId,\n            title: this.projectTitle,\n            description: this.projectDescription,\n          },\n        };\n\n        // Tạo JSON string\n        const dataStr = JSON.stringify(exportData, null, 2);\n\n        // Tạo blob để download\n        const blob = new Blob([dataStr], { type: \"application/json\" });\n        const url = URL.createObjectURL(blob);\n\n        // Tạo link và kích hoạt download\n        const a = document.createElement(\"a\");\n        a.download = `${this.projectTitle || \"content\"}_export.json`;\n        a.href = url;\n        a.click();\n\n        // Giải phóng URL object\n        URL.revokeObjectURL(url);\n\n        this.saveMessage = \"Content exported successfully!\";\n        this.saveStatus = \"success\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      } catch (error) {\n        console.error(\"Error exporting content:\", error);\n        this.saveMessage = \"Failed to export content: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    shareContent() {\n      // Xử lý chia sẻ nội dung - có thể thông qua email hoặc mạng xã hội\n      try {\n        // Kiểm tra nếu Web Share API được hỗ trợ\n        if (navigator.share) {\n          navigator\n            .share({\n              title: this.projectTitle || \"My Content\",\n              text: `Check out my content: ${this.projectTitle || \"Content\"}`,\n              url: window.location.href,\n            })\n            .then(() => {\n              this.saveMessage = \"Content shared successfully!\";\n              this.saveStatus = \"success\";\n            })\n            .catch((error) => {\n              throw error;\n            });\n        } else {\n          // Fallback - copy URL vào clipboard\n          navigator.clipboard.writeText(window.location.href).then(() => {\n            this.saveMessage = \"URL copied to clipboard!\";\n            this.saveStatus = \"success\";\n          });\n        }\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      } catch (error) {\n        console.error(\"Error sharing content:\", error);\n        this.saveMessage = \"Failed to share content: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    downloadPDF() {\n      try {\n        // Thông báo cho người dùng rằng chức năng đang được phát triển\n        this.saveMessage = \"PDF download feature will be available soon.\";\n        this.saveStatus = \"success\";\n\n        // Xóa thông báo sau 3 giây\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n\n        // NOTE: Chức năng này sẽ được triển khai trong bản cập nhật tới\n        // Sử dụng thư viện như jsPDF hoặc html2pdf.js để tạo PDF từ nội dung\n      } catch (error) {\n        console.error(\"Error downloading PDF:\", error);\n        this.saveMessage = \"Failed to download PDF: \" + error.message;\n        this.saveStatus = \"error\";\n\n        // Clear message after 3 seconds\n        setTimeout(() => {\n          this.saveMessage = null;\n        }, 3000);\n      }\n    },\n    goToDashboard() {\n      this.$emit(\"go-to-dashboard\");\n    },\n    async generateImageForContent() {\n      if (!this.contentId) return;\n\n      try {\n        this.imageLoading = true;\n        this.imageError = null;\n\n        console.log(`Generating image for content ID: ${this.contentId}`);\n\n        // Timeout 3 phút (180000ms)\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), 180000);\n\n        try {\n          const response = await fetch(\n            `/api/content/contents/${this.contentId}/generate-image`,\n            {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n              body: JSON.stringify({ style: \"Realistic\" }),\n              signal: controller.signal,\n            }\n          );\n\n          // Xoá timeout nếu request thành công\n          clearTimeout(timeoutId);\n\n          if (!response.ok) {\n            throw new Error(`Error generating image: ${response.statusText}`);\n          }\n\n          const data = await response.json();\n          console.log(\"Image generation response:\", data);\n\n          if (data.success && data.data && data.data.imageUrl) {\n            console.log(\"New image URL:\", data.data.imageUrl);\n            this.localImage = data.data.imageUrl;\n            this.$emit(\"update:image\", data.data.imageUrl);\n            this.showToast(\"Image generated successfully\", \"success\");\n          } else {\n            throw new Error(\"Image generation did not return a valid URL\");\n          }\n        } catch (requestError) {\n          clearTimeout(timeoutId);\n\n          if (requestError.name === \"AbortError\") {\n            throw new Error(\n              \"Request timeout: Image generation is taking too long\"\n            );\n          }\n\n          throw requestError;\n        }\n      } catch (error) {\n        console.error(\"Error generating image for content:\", error);\n        this.imageError = error.message;\n\n        // Kiểm tra nếu lỗi liên quan đến FastAPI service\n        if (\n          error.message.includes(\"Failed to fetch\") ||\n          error.message.includes(\"NetworkError\") ||\n          error.message.includes(\"timeout\") ||\n          error.message.includes(\"ECONNREFUSED\")\n        ) {\n          this.showToast(\n            \"Error connecting to image generation service. Please make sure the service is running at http://localhost:8000\",\n            \"error\"\n          );\n        } else {\n          this.showToast(`Error generating image: ${error.message}`, \"error\");\n        }\n      } finally {\n        this.imageLoading = false;\n      }\n    },\n    showToast(message, type = \"info\") {\n      // Clear any existing timeout\n      if (this.toastObj.timeout) {\n        clearTimeout(this.toastObj.timeout);\n      }\n\n      // Set toast properties\n      this.toastObj.show = true;\n      this.toastObj.message = message;\n      this.toastObj.type = type;\n\n      // Auto hide after 5 seconds\n      this.toastObj.timeout = setTimeout(() => {\n        this.toastObj.show = false;\n      }, 5000);\n\n      // Log for debugging\n      console.log(`Toast: ${type} - ${message}`);\n    },\n  },\n  watch: {\n    generatedImage: {\n      immediate: true,\n      handler(newValue) {\n        this.localImage = newValue;\n      },\n    },\n  },\n};\n</script>\n\n<style scoped>\n.step-content {\n  background: white;\n  border-radius: 12px;\n  padding: 2rem;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n\nh2 {\n  color: #1c1c4c;\n  margin-bottom: 1.5rem;\n  text-align: center;\n  font-weight: 600;\n}\n\n.project-info {\n  background: #f8f9fa;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 2rem;\n}\n\n.project-info h3 {\n  color: #1c1c4c;\n  margin: 0 0 0.5rem 0;\n}\n\n.project-info p {\n  color: #6c757d;\n  margin: 0 0 1rem 0;\n}\n\n.project-status {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: 0.5rem;\n}\n\n.status-badge {\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-weight: bold;\n}\n\n.status-badge.in_progress {\n  background-color: #ecedf7;\n  color: #1c1c4c;\n}\n\n.status-badge.finished {\n  background-color: #e8f5e9;\n  color: #28a745;\n}\n\n.status-button {\n  background: transparent;\n  border: 1px solid #1c1c4c;\n  color: #1c1c4c;\n  padding: 0.25rem 0.75rem;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.8rem;\n  transition: all 0.3s ease;\n}\n\n.status-button:hover {\n  background: #ecedf7;\n}\n\n.final-content {\n  display: grid;\n  gap: 2rem;\n  margin-bottom: 2rem;\n}\n\n.final-content h3 {\n  margin-bottom: 1rem;\n  color: #1c1c4c;\n  font-weight: 600;\n}\n\n.content-box {\n  white-space: pre-wrap;\n  line-height: 1.6;\n  font-family: \"Arial\", sans-serif;\n  padding: 1.5rem;\n  background: white;\n  border-radius: 8px;\n  border: 1px solid #e9ecef;\n  max-height: 400px;\n  overflow-y: auto;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n}\n\n.content-box p {\n  margin-bottom: 1rem;\n}\n\n.content-box h1,\n.content-box h2,\n.content-box h3,\n.content-box h4,\n.content-box h5,\n.content-box h6 {\n  margin-top: 1.5rem;\n  margin-bottom: 1rem;\n  color: #1c1c4c;\n}\n\n.final-image-section {\n  background: #f8f9fa;\n  border-radius: 8px;\n  padding: 2rem;\n  margin-bottom: 2rem;\n}\n\n.final-image-section h3 {\n  margin-bottom: 1.5rem;\n  color: #1c1c4c;\n  font-weight: 600;\n}\n\n.image-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.image-section img {\n  max-width: 100%;\n  max-height: 300px;\n  object-fit: contain;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.no-image-placeholder {\n  width: 100%;\n  height: 200px;\n  background: #e9ecef;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  color: #6c757d;\n  font-style: italic;\n  padding: 1rem;\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.no-image-placeholder p {\n  margin-top: 0.5rem;\n  font-size: 0.9rem;\n}\n\n.image-actions {\n  margin-top: 1rem;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n\n.final-actions {\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n}\n\n.additional-actions {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n  justify-content: center;\n}\n\n.navigation-buttons {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  justify-content: center;\n}\n\n.action-buttons {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n  justify-content: center;\n}\n\n.btn {\n  min-width: 120px;\n  text-align: center;\n  padding: 0.75rem 1.25rem;\n  border-radius: 6px;\n  font-size: 0.9rem;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n}\n\n.btn-primary {\n  background: #1c1c4c;\n  color: white;\n  border: none;\n}\n\n.btn-primary:hover {\n  background: #2a2a6c;\n}\n\n.btn-outline-primary {\n  background: transparent;\n  border: 1px solid #1c1c4c;\n  color: #1c1c4c;\n}\n\n.btn-outline-primary:hover {\n  background: #ecedf7;\n}\n\n.btn-light {\n  background: white;\n  color: #1c1c4c;\n  border: 1px solid #1c1c4c;\n}\n\n.btn-light:hover {\n  background: #f8f9fa;\n}\n\n.btn-info {\n  background: white;\n  color: #1c1c4c;\n  border: 1px solid #1c1c4c;\n}\n\n.btn-info:hover {\n  background: #f8f9fa;\n}\n\n.btn-success {\n  background: #1c1c4c;\n  color: white;\n  border: none;\n}\n\n.btn-success:hover {\n  background: #2a2a6c;\n}\n\n.error-message {\n  color: #dc3545;\n  font-size: 0.9rem;\n  margin-top: 0.5rem;\n}\n\n.project-info.warning {\n  background-color: #fff3cd;\n  border: 1px solid #ffeeba;\n  color: #856404;\n}\n\n.status-button:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.save-message {\n  margin-top: 1rem;\n  padding: 0.75rem;\n  border-radius: 4px;\n  text-align: center;\n  font-size: 0.9rem;\n}\n\n.save-message.success {\n  background-color: #e8f5e9;\n  color: #2e7d32;\n}\n\n.save-message.error {\n  background-color: #ffebee;\n  color: #c62828;\n}\n\n@media (max-width: 768px) {\n  .action-buttons,\n  .navigation-buttons,\n  .additional-actions {\n    flex-direction: column;\n    width: 100%;\n  }\n\n  .action-buttons button,\n  .navigation-buttons button,\n  .additional-actions button {\n    width: 100%;\n    margin-bottom: 0.5rem;\n  }\n\n  .btn {\n    width: 100%;\n  }\n}\n\n/* Toast Styles */\n.toast-container {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  min-width: 300px;\n  max-width: 450px;\n  background-color: white;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n  z-index: 1000;\n  display: flex;\n  overflow: hidden;\n  animation: slideIn 0.3s ease-out forwards;\n}\n\n.toast-container.success {\n  border-left: 4px solid #28a745;\n}\n\n.toast-container.error {\n  border-left: 4px solid #dc3545;\n}\n\n.toast-container.info {\n  border-left: 4px solid #17a2b8;\n}\n\n.toast-content {\n  flex: 1;\n  padding: 12px 15px;\n  display: flex;\n  align-items: center;\n}\n\n.toast-icon {\n  margin-right: 12px;\n  font-size: 1.25rem;\n}\n\n.toast-container.success .toast-icon {\n  color: #28a745;\n}\n\n.toast-container.error .toast-icon {\n  color: #dc3545;\n}\n\n.toast-container.info .toast-icon {\n  color: #17a2b8;\n}\n\n.toast-message {\n  flex: 1;\n  color: #333;\n}\n\n.toast-close {\n  background: none;\n  border: none;\n  color: #aaa;\n  font-size: 1.5rem;\n  padding: 8px 12px;\n  cursor: pointer;\n  align-self: flex-start;\n}\n\n.toast-close:hover {\n  color: #555;\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}